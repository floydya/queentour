use('../../node_modules/mantis-querist')
@require '../../node_modules/mantis-querist/src/mantis-querist'

//
// Fixes of built-in mantis-querist function
//
key-index(obj, key)
  $i = 0

  for $key, $val in obj
    if $key == key
      return $i

    $i += 1

  return 0

// bp-index($bp)
//   return key-index($mantis.querist.breakpoints, $bp)

// query(args..., $type = $mantis.querist.type)
//   $fn-name = fn-name()
//   $mq = join-media-query($type: $type)
//   $breakpoints = $mantis.querist.breakpoints
//   $unit = $mantis.querist.unit

//   p(('a fn-name' $fn-name))

//   if $fn-name is 'to'
//     $min = keys($breakpoints)[0]
//     $max = args[0]
//   else if $fn-name is 'from'
//     $min = args[0]
//     $max = keys($breakpoints)[length($breakpoints) - 1]
//   else if $fn-name is 'at'
//     $min = args[0]
//     $max = keys($breakpoints)[bp-index($min)]
//   else if $fn-name is 'between'
//     $min = args[0]
//     $max = args[1]

//   unless bp-index($min) is 0
//     $mq = join-media-query($mq, $feature: '(min-width: ' + $breakpoints[$min] + $unit + ')')

//   if $max
//     $next = bp-index($max) + 1

//     unless $next is length($breakpoints)
//       $max = keys($breakpoints)[$next]
//       if $max
//         $mq = join-media-query($mq, $feature: '(max-width: ' + $breakpoints[$max] + $unit + ')')

//   p(($min $max args $mq $max==null))

//   return $mq

// from = to = at = between = query

@require 'breakpoints'
@require 'properties'
